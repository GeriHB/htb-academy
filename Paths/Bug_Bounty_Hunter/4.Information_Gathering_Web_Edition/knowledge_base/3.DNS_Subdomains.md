# DNS

Translates human-readable domain names such as `www.google.com` into a numerical ip address.

## How DNS works?

The process of how DNS works if we want to visit `www.example.com` website.

- Computer first checks its memory(cache) to see if it remembers it from a previous visit - if not, reaches out to a **DNS resolver** usually provided by the ISP.
- The DNS resolver has a cache, and if it isn't there, it searches through the DNS hierarchy, first asks a root name server.
- Root server doesn't know the exact address but knows who does - TLD (Top-Level Domain) name server responsible for the domain ending (.com, .org, etc). It points the resolver in the right direction.
- TLD name server knows which authoritative name server is responsible for the domain and sends the resolver there.
- The authoritative name server is the final stop, which holds the correct IP address and sends it back to the resolver.
- The resolver receives the IP address and gives it to the computer.
- The computer connects to it.

Computer -> Resolver -> Root server -> TLD Server -> Authoritative server -> TLD Server -> Root Server -> Resolver -> Computer.

**Hosts File**
Provides a manual method of domain name resolution which bypasses the DNS process. It can be useful for development, troubleshooting or blocking websites.

**DNS file**
In the DNS, a `zone` is a part of the domain namespace that a specific entity or adminsitrator manages.

A domain and all of the subdomains typically belong to the same DNS zone.

The zone file resides on a DNS server, defines the resource records within this zone, which has crucial information for translating domain names into IP addresses.

Zone file example:

```sh
$TTL 3600 ; Default Time-To-Live (1 hour)
@       IN SOA   ns1.example.com. admin.example.com. (
                2024060401 ; Serial number (YYYYMMDDNN)
                3600       ; Refresh interval
                900        ; Retry interval
                604800     ; Expire time
                86400 )    ; Minimum TTL

@       IN NS    ns1.example.com.
@       IN NS    ns2.example.com.
@       IN MX 10 mail.example.com.
www     IN A     192.0.2.1
mail    IN A     198.51.100.1
ftp     IN CNAME www.example.com.
```

# Digging DNS

`dig` is a tool to query DNS servers and retrieve a number of DNS records.

Common commands:

|Command|Description|
|-------|----------|
|dig x.com|default A record lookup|
|dig x.com A|IPv4 address|
|dig x.com AAAA|IPv6 address|
|dig x.com MX| mail server|
|dig x.com NS| authoritative name server|
|dig x.com TXT| txt records|
|dig x.com CNAME| canonical name|
|dig x.com SOA| start of authority|
|dig @1.1.1.1 x.com|specifies a name server to query|
|dig +trace x.com| full path of dns resolution|
|dig -x 192.168.0.1|reverse lookup on the ip address - you may need a name server|
|dig +short x.com|short answer to the query|
|dig +noall +answer x.com|only the answer section of the output|
|dig x.com ANY| All available DNS records for the domain|

