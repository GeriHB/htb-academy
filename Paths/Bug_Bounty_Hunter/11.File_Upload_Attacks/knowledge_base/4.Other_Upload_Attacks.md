# Other Upload Attacks

## Injections in File Name

A common file upload attack uses a malicious string for the uploaded file name, which can get executed if the uploaded file name is displayed on the page.

For example if we name a file `file$(whomai).jpg` or `file.jpg||whoami`, and then the web app attempts to move the uploaded file with the OS command, then our file name would inject the `whoami` command which can get executed.

## Upload Directory Disclosure

Sometimes we can't see the directory of the file that has been uploaded.

We can fuzz to look for the directory, or other vulnerabilities such as `LFI/XXE` and find the source code to read the directory name.

Another method is to force error messages, and reveal helpful information. For example to upload a file with a name that exists or sending two identical requests simultaneously, which may lead the web server to show an error that it could not write the file, which may disclose the uplaods directory. Or maybe upload a file with a very long name.

## Windows-specific Attacks

One such attack is using reserver characters `(|,<,>,*, or ?)` which are reserved as wildcards, and if the web ap pdoesn't sanitize them they may refer to other files that doesn't exist and cause an error that shows the directory.

Aksi we can use Windows reserved names for the uploaded file name `(CON, COM1, LPT1, or NUL)` which can cause an error as the web app wil not be allowed to write a file with this name.

We can use also the **Filename Convention**o overwrite existing files or refer to files that don't exist. We can use a `~` to complete file name, on older versions of Windows, for example to refer to `hackthebox.txt` we can use `HAC~.TXT` where the digit represents the order of the matching files that start with `HAC`. We can write a file `WEB~.CONF` to overwrite the `web.conf`.


So we can write a file that replaces sensitive system files, attack which can lead to several outcomes, like causing information disclosure through errors, causing a DoS on the back-end server, or even accessing private files.

