# Introduction

Template Engines makes use of common static parts such as `header, navigation bar, footer` in order to make most of the web app look the same when navigating the pages.

Then the other part of the web pages is laoded dynamically.

This is why sometimes we see `/index.php?page=about` where the static part comes from the `index.php` and pulls the dynamic content `specified in the parameter`, which in this case will be read from `about.php`.

So these parameters are used to specify which resource is shown on the page, and if this functionality is not properly secured, an attacker can manipulate these parameters to display the content of any local file, which is known as the **Local File Inclusion**.

This vulnerability can lead to **code disclosure, sensitive data explosure, and RCE**.

It can happen on most popular web servers and development frameworks, and they all share one common thing - they load a file from a path.

Such a file can be a `dynamic header` or `different content` based on the user-specified language.

## Examples

### PHP

If we use the `inlcude()` function to load a file, and if the path passed to the function is taken from a user-controlled parameter, and it's not sanitized, then it is vulnerable to File Inclusion

```php
if (isset($_GET['language'])) {
    include($_GET['language']);
}
```

With this code in the backend, everything passed to the `language` parameter will be loaded on the page.

### Express.js

```js
app.get("/about/:language", function(req, res) {
    res.render(`/${req.params.language}/about.html`);
});
```

This example takes the parameter from the URL path like `/about/en`, and it is directly used within `render()`. An attacker can change the URL and show a different file instead.

### Java

```java
<c:if test="${not empty param.language}">
    <jsp:include file"<%= request.getParameter('language') %>" />
<c:if>
```

The `include` function takes a file or a page URL as it's argument and renders the object into front-end template. It can be used to render a local file or a URL.

## Not just Read -> Execute

In the examples above we are reading files. But, what if we can use that to execute.

Some functions allow us to execute the specified files, which can lead to code execution.

Some functions that allow executing files or even specifying a `remote URL`:

|   PHP         |  Execute      |   Remote URL      | 
|---------------|---------------|-------------------|
| include()     |    allow      |   allow           |
| include_once() |    allow      |   allow           |
|file_get_contents()|X|allow|
|require(), require_once() | allow| X|
|**NodeJS**| | |
|res.render()|allow|X|
|**Java**|||
|import|allow|allow|
|**.Net**|||
|include|allow|allow|
|@Html.RemotePartial()|X|allow|


